import{g as N,u as M,r as m,o as R,a as T,c as b,b as s,d as K,w as n,e as t,t as f,f as v,h as l,i as D,j as L,k,l as E,m as g}from"./index-DtepjGgS.js";import{a as C}from"./api-Dwt0tebd.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"tableImage"},U={class:"d-flex justify-center align-center justTransparent",style:{height:"100%"}},A={class:"loginCardBg pa-6 rounded",style:{color:"#32435F"}},P={class:"d-flex justify-space-between align-center"},q={class:"text-h7 text-sm-h5 font-weight-bold"},z={class:"text-caption text-sm-h6"},G={class:"d-flex justify-end mt-2 titleFontColor"},H={key:1},Q={__name:"index",setup(W){const{proxy:r}=N(),i=M(),w=E(),y=m(null),d=m(!1),c=m({account:"",password:""}),F=[o=>!!o||"不可空白"],V=()=>{sessionStorage.getItem("logined")==="logined"&&w.push("/main/functionlist")},S=async()=>{try{const o=await C.get("other_data");console.log("response",o);const e=o[0];e&&(i.cData=e,sessionStorage.setItem("cData",JSON.stringify(e)),d.value=!0)}catch(o){d.value=!1,console.error(o),r.$swal({icon:"error",title:"資料庫未正常連結!! 請按 CTRL+F5 後重新登入~ 或洽系統工程師"})}},u=async()=>{const{valid:o}=await y.value.validate();if(o)try{const e=`login/logining/${i.state.databaseName}`,a=await C.options(e,c.value);console.log("login response",a),a.data==="databaseError"?r.$swal({icon:"error",title:"資料庫未正常連結!! 請按F5後重新登入~"}):a.state==="logined"?a.pData.suspension?r.$swal({icon:"error",title:"停權中!!! 無法登入!!"}):(i.pData=a.pData,sessionStorage.setItem("pData",JSON.stringify(a.pData)),sessionStorage.setItem("logined","logined"),w.push("/main/functionlist"),r.$swal({icon:"success",title:"登入成功"})):r.$swal({icon:"error",title:"未授權的登入者"})}catch{r.$swal({icon:"error",title:"登入失敗，請檢查帳號密碼"})}};return R(()=>{S()}),T(()=>{V()}),(o,e)=>{const a=l("v-divider"),x=l("v-text-field"),p=l("v-col"),h=l("v-row"),I=l("v-btn"),$=l("v-spacer"),j=l("v-icon"),B=l("v-form");return g(),b("div",O,[s("div",U,[d.value?(g(),K(h,{key:0,class:"justify-center"},{default:n(()=>[t(p,{cols:"11",md:"7"},{default:n(()=>[s("div",A,[s("div",P,[s("div",q,f(v(i).cData.company_name)+" 後台管理系統 ",1),s("div",z," ver."+f(v(i).state.verMsg),1)]),t(a),t(B,{class:"mt-3",ref_key:"form",ref:y},{default:n(()=>[t(h,null,{default:n(()=>[t(p,{cols:"12"},{default:n(()=>[t(x,{label:"授權帳號 (Account)","prepend-icon":"mdi-codepen",modelValue:c.value.account,"onUpdate:modelValue":e[0]||(e[0]=_=>c.value.account=_),rules:F,onKeyup:D(u,["enter"]),autofocus:"",color:"#FFFFFF"},null,8,["modelValue"])]),_:1}),t(p,{cols:"12"},{default:n(()=>[t(x,{type:"password",label:"密碼 (Password)","prepend-icon":"mdi-onepassword",modelValue:c.value.password,"onUpdate:modelValue":e[1]||(e[1]=_=>c.value.password=_),rules:F,onKeyup:D(u,["enter"]),color:"#FFFFFF"},null,8,["modelValue"])]),_:1})]),_:1}),t(I,{block:"",class:"mt-2 pa-2 white--text",color:"#32435F",onClick:L(u,["stop"])},{default:n(()=>[...e[2]||(e[2]=[k("登入",-1)])]),_:1}),s("div",G,[s("span",null,f(v(i).cData.last_login_time),1),t($),t(j,null,{default:n(()=>[...e[3]||(e[3]=[k("mdi-registered-trademark",-1)])]),_:1}),e[4]||(e[4]=s("span",null,"2025.07.03",-1))])]),_:1},512)])]),_:1})]),_:1})):(g(),b("div",H,[...e[5]||(e[5]=[s("h1",{class:"white--text titleFontColor"}," 資料庫未正常連結!! 請按 CTRL+F5 後重新登入~ 或洽系統工程師 ",-1)])]))])])}}},ee=J(Q,[["__scopeId","data-v-86543dbb"]]);export{ee as default};
